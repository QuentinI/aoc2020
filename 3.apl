Z←⎕FIO[49] '3.in'
L←⍬⍴(⍴∊Z)÷⍴Z
R←{((⍴Z)⍴(1,0×⍳(⍺-1)))×((L|⍵×((⌈(⍳⍴Z)÷⍺)-1))+1)×'#'=Z}
{+/∊({(⍳⍴⍵)}¨⍵)=⍵}(1 R 3)
×/{+/∊({(⍳⍴⍵)}¨⍵)=⍵}¨({⍵[1] R ⍵[2]}¨((1 1) (1 3) (1 5) (1 7) (2 1)))
